syntax = "proto3";

package vault;

// A single credential entry (stored in plaintext form before encryption)
message Credential {
    string title = 1;
    string username = 2;
    string password = 3;
    string url = 4;
    string notes = 5;
}

// An encrypted credential entry with its own encryption metadata
message EncryptedEntry {
    // Random nonce used for this entry's encryption (12 bytes)
    bytes nonce = 1;
    // Encrypted credential data (ciphertext + auth tag)
    bytes ciphertext = 2;
}

// The vault containing all encrypted entries and metadata
message Vault {
    // Magic identifier for vault format (should be "TUIPASS2")
    string magic = 1;
    // Vault format version
    uint32 version = 2;
    // Random salt for key derivation (16 bytes)
    bytes salt = 3;
    // Encrypted credential entries
    repeated EncryptedEntry entries = 4;
}
